{
  "$id": "telemetry/run_metric.schema.json",
  "type": "object",
  "required": [
    "task_id",
    "platform",
    "model",
    "tokens_prompt",
    "tokens_output",
    "latency_ms",
    "success"
  ],
  "properties": {
    "task_id": {
      "type": "string"
    },
    "platform": {
      "type": "string"
    },
    "model": {
      "type": "string"
    },
    "tokens_prompt": {
      "type": "integer"
    },
    "tokens_output": {
      "type": "integer"
    },
    "cost_usd": {
      "type": "number",
      "description": "Vibeflow actual API cost for this run (if any)."
    },
    "latency_ms": {
      "type": "integer"
    },
    "success": {
      "type": "boolean"
    },
    "retries": {
      "type": "integer"
    },
    "validation_passed": {
      "type": "boolean"
    },
    "external_chat_url": {
      "type": "string"
    },
    "counterfactual_api_cost_usd": {
      "type": "number"
    },
    "est_tokens_prompt": {
      "type": "integer"
    },
    "est_tokens_output": {
      "type": "integer"
    },
    "attempt_idx": {
      "type": "integer"
    }
  }
}
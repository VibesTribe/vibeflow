{
  "$id": "telemetry/cost_ledger.schema.json",
  "type": "object",
  "required": [
    "scope",
    "scope_id",
    "totals"
  ],
  "properties": {
    "scope": {
      "enum": [
        "task",
        "slice",
        "project"
      ]
    },
    "scope_id": {
      "type": "string"
    },
    "totals": {
      "type": "object",
      "required": [
        "vibeflow_cost_usd",
        "counterfactual_api_cost_usd",
        "savings_usd",
        "roi_percent"
      ],
      "properties": {
        "vibeflow_cost_usd": {
          "type": "number"
        },
        "counterfactual_api_cost_usd": {
          "type": "number"
        },
        "savings_usd": {
          "type": "number"
        },
        "roi_percent": {
          "type": "number"
        }
      }
    },
    "by_platform": {
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "platform",
          "vibeflow_cost_usd",
          "counterfactual_api_cost_usd"
        ],
        "properties": {
          "platform": {
            "type": "string"
          },
          "model": {
            "type": "string"
          },
          "vibeflow_cost_usd": {
            "type": "number"
          },
          "counterfactual_api_cost_usd": {
            "type": "number"
          }
        }
      }
    }
  }
}
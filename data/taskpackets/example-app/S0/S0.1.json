{
  "task_id": "S0.1",
  "title": "Wire Repo Snapshot Writer",
  "purpose": "Emit docs/reports/repo-snapshot.json with git metadata for downstream agents.",
  "confidence": 0.97,
  "context": {
    "goal": "Ensure every agent reads the same repo snapshot, OpenSpec digest, and synced state.",
    "snapshot_path": "docs/reports/repo-snapshot.json"
  },
  "dependencies": [],
  "deliverables": [
    "scripts/context/write-repo-snapshot.mjs"
  ],
  "output_format": {
    "language": "JavaScript",
    "version": "ES2020",
    "format": "text",
    "files": [
      "scripts/context/write-repo-snapshot.mjs"
    ]
  },
  "instructions": [
    "Read the repo tree (exclude .git, node_modules) and emit docs/reports/repo-snapshot.json.",
    "Capture per-file sha256, byte size, and modified timestamp; include git commit + branch.",
    "Keep memory footprint low by streaming directory traversal.",
    "Return the updated script file inside <FILE> fences."
  ],
  "acceptance_criteria": [
    "npm run context:snapshot succeeds",
    "docs/reports/repo-snapshot.json includes git metadata and file list",
    "Unit tests cover happy path + ignored directories"
  ],
  "review_policy": "auto",
  "validation": [
    {
      "name": "unit-tests",
      "tool": "npm test"
    },
    {
      "name": "manual-run",
      "tool": "npm run context:snapshot"
    }
  ],
  "execution": {
    "platform": "vscode-codex",
    "model": "openai:gpt-4.1-mini",
    "budget_usd": 0.25,
    "max_tokens": 6000,
    "latency_slo_ms": 60000
  }
}
